!function(t,i){"use strict";"function"==typeof define&&define.amd?define(["jquery","DragEvent"],i):"object"==typeof exports?module.exports=i(require("jquery"),require("DragEvent")):(t.bjj=t.bjj||{},t.bjj.Slider=i(t.jQuery,t.bjj.DragEvent))}(this,function(t,i){"use strict";function s(){this._init.apply(this,arguments)}function e(i,s,e){var h=t();t.each(i,function(i,s){for(var e,n=s instanceof jQuery?s:t(s),r=n.parents().andSelf().filter(":hidden"),i=r.length;i--&&n.is(":hidden");)e=r.eq(i),"none"===e.css("display")&&(h=h.add(e.show()))}),"function"==typeof s&&s.call(e||this),h.hide()}var h=!1,n=navigator.appVersion.match(/MSIE (\d+\.\d)/),r=n&&n[1]-0;"Microsoft Internet Explorer"===navigator.appName&&8>=r&&(h=!0);var a=!!navigator.userAgent.match(/mobile/i),o=t(window),c={prevBtn:null,nextBtn:null,btnDisableClass:"disabled",align:"start",isVer:!1,offset:0,activeClass:"active",initIndex:0,duration:400,aequilate:!0,onClick:function(){},onSlide:function(){}},l=s.prototype;return l._init=function(i,s){var e=t.extend({},c,s);this.$container=t(i).css({overflow:"hidden","user-select":"none",cursor:"-webkit-grab"}),"static"===this.$container.css("position")&&this.$container.css("position","relative"),this.$wrap=this.$container.children().first(),this.$prevBtn=t(e.prevBtn),this.$nextBtn=t(e.nextBtn),this.hasPrevBtn=!!this.$prevBtn.length,this.hasNextBtn=!!this.$nextBtn.length,this.btnDisableClass=e.btnDisableClass,this.isVer=e.isVer,this.offset=e.offset,this.activeClass=e.activeClass,this.duration=e.duration,this.aequilate=e.aequilate,this.onClick=e.onClick,this.onSlide=e.onSlide,this.hasPrevBtn&&this.$prevBtn.css("user-select","none"),this.hasNextBtn&&this.$nextBtn.css("user-select","none"),"end"===e.align?this.isEnd=!0:"center"===e.align?this.isCenter=!0:this.isStart=!0,t.cssHooks.x?(this.tabAttr=this.isVer?"y":"x",t.support.transform3d&&this.$wrap.css("z",0)):this.tabAttr=this.isVer?"top":"left",this.isVer?(this.beforeType="top",this.afterType="bottom",this.sizeApi="height",this.$container.width(this.$wrap.outerWidth(!0))):(this.beforeType="left",this.afterType="right",this.sizeApi="width",this.$container.height(this.$wrap.outerHeight(!0))),this.$wrap.css({position:"absolute",left:0,right:0,top:0,bottom:0}),this.prevPage=t.proxy(this,"prevPage"),this.nextPage=t.proxy(this,"nextPage"),this._resize=t.proxy(this,"_resize"),this._onClick=t.proxy(this,"_onClick"),this._onSlide=t.proxy(this,"_onSlide"),this.update(e.initIndex),this._addEvent()},l._addEvent=function(){o.on("resize",this._resize),a?(this.hasPrevBtn&&this.$prevBtn.on("touchend",this.prevPage),this.hasNextBtn&&this.$nextBtn.on("touchend",this.nextPage)):(this.hasPrevBtn&&this.$prevBtn.on("click",this.prevPage),this.hasNextBtn&&this.$nextBtn.on("click",this.nextPage)),this.startPos=0,this.curPos=0,this.horizontal=!1,this.vertical=!1,this.startX=0,this.startY=0,this.dx=0,this.dy=0,this.r=.5,this.dragEvent=new i({obj:this.$wrap,holder:this,start:this._touchstartHandler,move:this._touchmoveHandler,end:this._touchendHandler}),this.$wrap.on("click",">",this._onClick)},l._removeEvent=function(){a?(this.hasPrevBtn&&this.$prevBtn.off("touchend",this.prevPage),this.hasNextBtn&&this.$nextBtn.off("touchend",this.nextPage)):(this.hasPrevBtn&&this.$prevBtn.off("click",this.prevPage),this.hasNextBtn&&this.$nextBtn.off("click",this.nextPage)),this.dragEvent&&this.dragEvent.remove(),this.$wrap.off("click",">",this._onClick)},l._resize=function(){t.contains(document,this.$container[0])&&e(this.$wrap,function(){var i=this.$item.first(),s=parseInt(i.css("margin-"+this.beforeType))+parseInt(i.css("border-"+this.beforeType+"-width")),e=parseInt(i.css("margin-"+this.afterType))+parseInt(i.css("border-"+this.afterType+"-width")),h=s-e,n=this.$item.last(),r=parseInt(n.css("margin-"+this.beforeType))+parseInt(n.css("border-"+this.beforeType+"-width")),a=parseInt(n.css("margin-"+this.afterType))+parseInt(n.css("border-"+this.afterType+"-width")),o=a-r,c=0,l=h+o;0===l&&(c=h),this.parentSize=this.$container[this.sizeApi](),this.itemSize=[],this.itemPos=[];var u=this,d=0,p=e+r,f=parseInt(this.$wrap.css("padding-"+this.beforeType))+parseInt(this.$wrap.css("padding-"+this.afterType));if(this.aequilate){var m=this.$item[this.sizeApi]()+p;this.$item.each(function(t){u.itemPos.push(-m*t+u.offset),u.itemSize.push(m)}),d=m*this.itemCount+l,this.displayCount=this.parentSize/m|0}else this.$item.each(function(i,s){u.itemPos.push(-d+u.offset);var e=t(s),h=e[u.sizeApi]("auto")[u.sizeApi]();e[u.sizeApi](h),h+=p,u.itemSize.push(h),d+=h}),d+=l;this.minPos=this.offset,this.maxPos=this.parentSize-f-d-c-this.offset,this.maxPos=Math.min(0,this.maxPos),this.$wrap[this.sizeApi](d),this.isStart?this.sizeRatio=0:this.isEnd?this.sizeRatio=1:this.isCenter&&(this.sizeRatio=.5),this.activeOffset=(this.parentSize-(l+c+2*this.offset))*this.sizeRatio,this.minIndex=Math.max(0,Math.floor(this._calculateMultiple(this.minPos)-this.sizeRatio)),this.maxIndex=Math.min(this.itemCount-1,Math.ceil(this._calculateMultiple(this.maxPos)-this.sizeRatio)),this._slide(0)},this)},l._limitIndex=function(t){return Math.max(this.minIndex,Math.min(this.maxIndex,t))},l._fixedRange=function(t){return Math.max(this.maxPos,Math.min(this.minPos,t))},l._outOfRange=function(t){return t>this.minPos&&(t*=.3),t<this.maxPos&&(t=.3*(t-this.maxPos)+this.maxPos),t},l._setItem=function(t){this.$item.removeClass(this.activeClass),this.$item.eq(t).addClass(this.activeClass)},l._gotoPos=function(t){var i={};i[this.tabAttr]=t,this.$wrap.css(i)},l._slide=function(t){"number"!=typeof t&&(t=this.duration),this.curIndex=this._limitIndex(this.curIndex);var i=this.itemPos[this.curIndex],s={};s[this.tabAttr]=this._fixedRange(i+this.activeOffset-this.itemSize[this.curIndex]*this.sizeRatio),this.$wrap.stop().animate(s,t,this._onSlide)},l._onSlide=function(){this.hasPrevBtn&&(this.curIndex===this.minIndex?this.$prevBtn.addClass(this.btnDisableClass):this.$prevBtn.removeClass(this.btnDisableClass)),this.hasNextBtn&&(this.curIndex===this.maxIndex?this.$nextBtn.addClass(this.btnDisableClass):this.$nextBtn.removeClass(this.btnDisableClass)),this.onSlide.call(this.itemArray[this.curIndex],this.curIndex)},l._onClick=function(t){var i=this.$item.index(t.currentTarget);this._setItem(i),this.onClick.call(t.currentTarget,i)},l._touchstartHandler=function(t,i){this.startX=i.x,this.startY=i.y,this.$container.css("cursor","-webkit-grabbing")},l._touchmoveHandler=function(t,i){if(this.dx=i.x-this.startX,this.dy=i.y-this.startY,!this.horizontal&&!this.vertical){var s=Math.abs(this.dx),e=Math.abs(this.dy);this.isVer?e>=s?(this.vertical=!0,this.$wrap.stop(),this.startPos=parseInt(this.$wrap.css(this.tabAttr))):(this.horizontal=!0,this.startX=i.x,this.startY=i.y):s>=e?(this.horizontal=!0,this.$wrap.stop(),this.startPos=parseInt(this.$wrap.css(this.tabAttr))):(this.vertical=!0,this.startX=i.x,this.startY=i.y)}!this.isVer&&!this.horizontal||this.isVer&&!this.vertical||(t.preventDefault(),this.curPos=this._outOfRange(this.isVer?this.startPos+this.dy:this.startPos+this.dx),this._gotoPos(this.curPos))},l._touchendHandler=function(t,i){if(this.$container.css("cursor","-webkit-grab"),this.isVer){if(this.horizontal=!1,!this.vertical)return;this.vertical=!1}else{if(this.vertical=!1,!this.horizontal)return;this.horizontal=!1}if(this.isVer&&(i.swipeTop||i.swipeBottom))i.swipeTop?this.nextPage():i.swipeBottom&&this.prevPage();else if(this.isVer||!i.swipeLeft&&!i.swipeRight){var s=this._calculateMultiple(this.curPos)-this.sizeRatio;this.curIndex=this.isVer?this.dy<0?Math.ceil(s-this.r):Math.floor(s+this.r):this.dx<0?Math.ceil(s-this.r):Math.floor(s+this.r),this._slide()}else i.swipeLeft?this.nextPage():i.swipeRight&&this.prevPage();return!1},l._calculateMultiple=function(t){var i=0,s=t-this.activeOffset-this.offset;if(this.aequilate)0>s&&(i=Math.max(0,-s)/this.itemSize[0]);else for(var e,h,n=0,r=this.itemCount;r>n;n++)if(e=this.itemPos[n],h=this.itemSize[n],s>e-h){i=Math.max(0,e-s)/h+n;break}return i},l.prevPage=function(){if(this.aequilate)this.curIndex-=this.displayCount;else for(var t,i=this.itemPos[this.curIndex],s=this.curIndex;s>=0&&(t=this.itemPos[s],!(t-i>=this.parentSize));s--)this.curIndex=s;this._slide()},l.nextPage=function(){if(this.aequilate)this.curIndex+=this.displayCount;else for(var t,i=this.itemPos[this.curIndex],s=this.curIndex,e=this.itemCount;e>s&&(t=this.itemPos[s],!(i-t>=this.parentSize));s++)this.curIndex=s;this._slide()},l.update=function(t){this.$item=this.$wrap.children(),this.itemCount=this.$item.length,this.itemArray=this.$item.toArray(),this.curIndex="number"==typeof t&&t>0&&t<this.itemCount?t:this.isEnd?itemCount-1:0,this.$item.eq(this.curIndex).addClass(this.activeClass),h?window.setTimeout(this._resize,0):this._resize()},l.gotoItem=function(t){this.curIndex=t,this._setItem(t),this._slide()},l.destroy=function(){this._removeEvent(),this.itemArray=null,this.$container=null,this.$wrap=null,this.$item=null,this.$prevBtn=null,this.$nextBtn=null},s});