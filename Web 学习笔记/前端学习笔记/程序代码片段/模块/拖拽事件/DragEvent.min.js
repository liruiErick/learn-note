!function(t,e){"use strict";"object"==typeof module&&"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(e):(t.bjj=t.bjj||{},t.bjj.DragEvent=e())}(this,function(){"use strict";function t(i){if(!(this instanceof t))return new t(i);this._options=e({},d,i),this._init()}function e(){var t,i,n,s,o,a=arguments[0]||{},r=typeof a,c=Object.prototype.toString,l=1,h=arguments.length,p=!1;for("boolean"===r&&(p=a,r=typeof(a=arguments[l]||{}),l++),"object"!==r&&"function"!==r&&(a={}),l===h&&(a=this,l--);l<h;l++)if(null!=(t=arguments[l]))for(i in t)n=a[i],a!==(s=t[i])&&(p&&s&&((o="[object Array]"===c.call(s))||"[object Object]"===c.call(s))?(o?(o=!1,n=n&&"[object Array]"===c.call(n)?n:[]):n=n&&"[object Object]"===c.call(n)?n:{},a[i]=e(p,n,s)):void 0!==s&&(a[i]=s));return a}function i(t){return Array.prototype.map.call(t,function(t){return t})}var n,s,o,a,r=!!navigator.userAgent.match(/mobile/i),c="ontouchend"in document,l=window.navigator.pointerEnabled,h=window.navigator.msPointerEnabled;r?c?(n="touchstart",s="touchmove",o="touchend",a="touchcancel"):l?(n="pointerdown",s="pointermove",o="pointerup"):h?(n="MSPointerDown",s="MSPointerMove",o="MSPointerUp"):(n="mousedown",s="mousemove",o="mouseup"):(n="mousedown",s="mousemove",o="mouseup");var p=function(t,e){},d={obj:null,holder:null,start:p,move:p,end:p};e(t.prototype,{constructor:t,_init:function(){return this._eventObj=this._options.obj||document.documentElement,this._callbackHolder=this._options.holder,this._touchID=-1,this._swipeDis=5,this._swipeTime=200,this._swipeH=!1,this._swipeV=!1,this._prevTime=0,this._data={rect:null,startX:0,startY:0,startLocalX:0,startLocalY:0,x:0,y:0,localX:0,localY:0,dx:0,dy:0,absDx:0,absDy:0,localDx:0,localDy:0,absLocalDx:0,absLocalDy:0,stepDx:0,stepDy:0,absStepDx:0,absStepDy:0,swipeLeft:!1,swipeRight:!1,swipeTop:!1,swipeBottom:!1,swipe:!1,startTime:0,dragTime:0,stepTime:0},this._eventObj=function(t,e){return t instanceof HTMLElement?[t]:"object"==typeof t&&t.length?i(t):t&&"string"==typeof t?("string"==typeof e&&(e=document.querySelector(e)),e instanceof HTMLElement||(e=document),i(e.querySelectorAll(t))):[]}(this._eventObj)[0],this._initProxy(),this._addEvent(),this},_initProxy:function(){for(var t in this)(function(t){return"function"==typeof t})(this[t])&&(this[t]=function(t,e){if("string"==typeof e){var i=t[e];e=t,t=i}if("function"==typeof t){var n=Array.prototype.slice,s=n.call(arguments,2),o=function(){return t.apply(e||this,s.concat(n.call(arguments)))};return o.guid=t.guid=t.guid||u++,o}}(this,t))},_addEvent:function(){this._eventObj.addEventListener(n,this._startDragHandler,{passive:!1})},_removeEvent:function(){this._eventObj.removeEventListener(n,this._startDragHandler),this._eventObj.removeEventListener(s,this._moveDragHandler),this._eventObj.removeEventListener(o,this._endDragHandler),a&&this._eventObj.removeEventListener(a,this._endDragHandler)},_startDragHandler:function(t){var i;switch(t.type){case"mousedown":case"pointerdown":case"MSPointerDown":i=t;break;case"touchstart":if(this._touchID>=0)return;i=t.changedTouches[0],this._touchID=i.identifier}var n=this._data,r=n.rect=this._getEventObjRect();n.startX=n.x=i.clientX,n.startY=n.y=i.clientY,n.startLocalX=n.localX=n.x-r.left,n.startLocalY=n.localY=n.y-r.top,n.dx=0,n.dy=0,n.absDx=0,n.absDy=0,n.localDx=0,n.localDy=0,n.absLocalDx=0,n.absLocalDy=0,n.stepDx=0,n.stepDy=0,n.absStepDx=0,n.absStepDy=0,n.swipeLeft=!1,n.swipeRight=!1,n.swipeTop=!1,n.swipeBottom=!1,n.swipe=!1,this._prevTime=n.startTime=n.dragTime=t.timeStamp,n.stepTime=0;var c=this._options.start;c&&!1===c.call(this._callbackHolder||this._eventObj,t,e({},n))?this._touchID=-1:(this._eventObj.addEventListener(s,this._moveDragHandler,{passive:!1}),this._eventObj.addEventListener(o,this._endDragHandler,{passive:!1}),a&&this._eventObj.addEventListener(a,this._endDragHandler,{passive:!1}))},_moveDragHandler:function(t){var i;switch(t.type){case"mousemove":case"pointermove":case"MSPointerMove":i=t;break;case"touchmove":if((i=t.changedTouches[0]).identifier!==this._touchID)return}var n=this._data,s=n.rect=this._getEventObjRect();n.stepDx=i.clientX-n.x,n.stepDy=i.clientY-n.y,n.absStepDx=Math.abs(n.stepDx),n.absStepDy=Math.abs(n.stepDy),n.x=i.clientX,n.y=i.clientY,n.localX=n.x-s.left,n.localY=n.y-s.top,n.dx=n.x-n.startX,n.dy=n.y-n.startY,n.absDx=Math.abs(n.dx),n.absDy=Math.abs(n.dy),n.localDx=n.localX-n.startLocalX,n.localDy=n.localY-n.startLocalY,n.absLocalDx=Math.abs(n.absLocalDx),n.absLocalDy=Math.abs(n.absLocalDy);var o=t.timeStamp;n.dragTime=o-n.startTime,n.stepTime=o-this._prevTime,this._prevTime=o,this._swipeH=n.absStepDx>this._swipeDis,this._swipeV=n.absStepDy>this._swipeDis;var a=this._options.move;a&&a.call(this._callbackHolder||this._eventObj,t,e({},n))},_endDragHandler:function(t){if(t&&t.type){switch(t.type){case"touchend":case"touchcancel":if(t.changedTouches[0].identifier!==this._touchID)return}var i=this._data;i.stepTime<this._swipeTime&&(this._swipeH&&(this._swipeH=!1,i.swipe=!0,i.stepDx<0?i.swipeLeft=!0:i.stepDx>0&&(i.swipeRight=!0)),this._swipeV&&(this._swipeV=!1,i.swipe=!0,i.stepDy<0?i.swipeTop=!0:i.stepDy>0&&(i.swipeBottom=!0))),(i.absDx>15||i.absDy>15)&&t.preventDefault()}this._eventObj.removeEventListener(s,this._moveDragHandler),this._eventObj.removeEventListener(o,this._endDragHandler),a&&this._eventObj.removeEventListener(a,this._endDragHandler);var n=this._options.end;n&&n.call(this._callbackHolder||this._eventObj,t,e({},i)),this._touchID=-1},_getEventObjRect:function(){if(this._eventObj.getBoundingClientRect)return this._eventObj.getBoundingClientRect();var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,e=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft;return{left:e,top:t,bottom:t+(window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight),right:e+(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)}},destroy:function(){this._removeEvent();for(var t in Object.getOwnPropertyNames(this))delete this[t];this.__proto__=Object.prototype},open:function(){return this._eventObj.addEventListener(n,this._startDragHandler,{passive:!1}),this},close:function(){return this._eventObj.removeEventListener(n,this._startDragHandler),this},stop:function(){return this._endDragHandler(),this},remove:function(){return this.close(),this.stop(),this}});var u=0;return t});