!function(t,e){"use strict";"object"==typeof module&&"object"==typeof exports?module.exports=e(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],e):(t.bjj=t.bjj||{},t.bjj.DragEvent=e(t.jQuery))}(this,function(t){"use strict";function e(){this._init.apply(this,arguments)}var s,i,n,a,o=!!navigator.userAgent.match(/mobile/i),r="ontouchend"in document,c=!!window.navigator.pointerEnabled,h=!!window.navigator.msPointerEnabled;o?r?(s="touchstart",i="touchmove",n="touchend",a="touchcancel"):c?(s="pointerdown",i="pointermove",n="pointerup"):h?(s="MSPointerDown",i="MSPointerMove",n="MSPointerUp"):(s="mousedown",i="mousemove",n="mouseup"):(s="mousedown",i="mousemove",n="mouseup"),e.startEvent=s,e.moveEvent=i,e.endEvent=n,e.cancelEvent=a,e.nameSpace=1;var l=e.prototype;return l.constructor=e,l._init=function(s){this.eventObj=s.obj||document.documentElement,this.callbackHolder=s.holder,this.startCallback=s.start,this.moveCallback=s.move,this.endCallback=s.end,this.startEvent=e.startEvent+"."+e.nameSpace,this.moveEvent=e.moveEvent+"."+e.nameSpace,this.endEvent=e.endEvent+"."+e.nameSpace,a&&(this.endEvent+=" "+e.cancelEvent+"."+e.nameSpace),e.nameSpace++,this.touchID=-1,this.swipeDis=5,this.swipeTime=200,this.swipeH=!1,this.swipeV=!1,this.prevTime=0,this.data={startX:0,startY:0,startLocalX:0,startLocalY:0,x:0,y:0,localX:0,localY:0,dx:0,dy:0,absDx:0,absDy:0,stepDx:0,stepDy:0,absStepDx:0,absStepDy:0,swipeLeft:!1,swipeRight:!1,swipeTop:!1,swipeBottom:!1,swipe:!1,startTime:0,stepTime:0},this._startDragHandler=t.proxy(this,"_startDragHandler"),this._moveDragHandler=t.proxy(this,"_moveDragHandler"),this._endDragHandler=t.proxy(this,"_endDragHandler"),this.$doc=t(document),this.$eventObj=t(this.eventObj),this.eventObj=this.$eventObj[0],this.$eventObj.on(this.startEvent,this._startDragHandler),this.eventTarget=null},l._startDragHandler=function(e){var s;switch(e.type){case"mousedown":case"pointerdown":case"MSPointerDown":s=e;break;case"touchstart":if(this.touchID>=0)return;s=e.originalEvent.changedTouches[0],this.touchID=s.identifier}var i=this.data;i.dx=0,i.dy=0,i.absDx=0,i.absDy=0,i.stepDx=0,i.stepDy=0,i.absStepDx=0,i.absStepDy=0,i.swipeLeft=!1,i.swipeRight=!1,i.swipeTop=!1,i.swipeBottom=!1,i.swipe=!1,i.startX=i.x=s.clientX,i.startY=i.y=s.clientY,i.stepTime=0,i.startTime=this.prevTime=e.timeStamp;var n=this._getEventObjRect();return i.startLocalX=i.localX=i.x-n.left,i.startLocalY=i.localY=i.y-n.top,this.eventTarget=e.currentTarget,this.startCallback&&this.startCallback.call(this.callbackHolder||this.eventTarget,e,t.extend({},i))===!1?void(this.touchID=-1):void this.$doc.on(this.moveEvent,this._moveDragHandler).on(this.endEvent,this._endDragHandler)},l._moveDragHandler=function(e){var s;switch(e.type){case"mousemove":case"pointermove":case"MSPointerMove":s=e;break;case"touchmove":if(s=e.originalEvent.changedTouches[0],s.identifier!=this.touchID)return}var i=this.data;i.dx=s.clientX-i.startX,i.dy=s.clientY-i.startY,i.absDx=Math.abs(i.dx),i.absDy=Math.abs(i.dy),i.stepDx=s.clientX-i.x,i.stepDy=s.clientY-i.y,i.absStepDx=Math.abs(i.stepDx),i.absStepDy=Math.abs(i.stepDy),i.x=s.clientX,i.y=s.clientY;var n=this._getEventObjRect();i.localX=i.x-n.left,i.localY=i.y-n.top;var a=e.timeStamp;i.stepTime=a-this.prevTime,this.prevTime=a,this.swipeH=i.absStepDx>this.swipeDis?!0:!1,this.swipeV=i.absStepDy>this.swipeDis?!0:!1,this.moveCallback&&this.moveCallback.call(this.callbackHolder||this.eventTarget,e,t.extend({},i))},l._endDragHandler=function(e){if(e&&e.type){switch(e.type){case"touchend":case"touchcancel":if(e.originalEvent.changedTouches[0].identifier!=this.touchID)return}var s=this.data;s.stepTime<this.swipeTime&&(this.swipeH&&(this.swipeH=!1,s.swipe=!0,s.stepDx<0?s.swipeLeft=!0:s.stepDx>0&&(s.swipeRight=!0)),this.swipeV&&(this.swipeV=!1,s.swipe=!0,s.stepDy<0?s.swipeTop=!0:s.stepDy>0&&(s.swipeBottom=!0))),(s.absDx>15||s.absDy>15)&&e.preventDefault()}this.$doc.off(this.moveEvent,this._moveDragHandler).off(this.endEvent,this._endDragHandler),this.endCallback&&this.endCallback.call(this.callbackHolder||this.eventTarget,e,t.extend({},s)),this.touchID=-1,this.eventTarget=null},l._getEventObjRect=function(){return this.eventObj.getBoundingClientRect?this.eventObj.getBoundingClientRect():{left:document.documentElement.scrollLeft||document.body.scrollLeft,top:document.documentElement.scrollTop||document.body.scrollTop}},l.open=function(){return this.$eventObj.on(this.startEvent,this._startDragHandler),this},l.close=function(){return this.$eventObj.off(this.startEvent,this._startDragHandler),this},l.stop=function(){return this._endDragHandler(),this},l.remove=function(){return this.close(),this.stop(),this},e});