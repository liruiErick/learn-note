!function(t,i){"use strict";"object"==typeof module&&"object"==typeof exports?module.exports=i(require("jquery.animate")):"function"==typeof define&&define.amd?define(["jquery.animate"],i):(t.bjj=t.bjj||{},t.bjj.LoopRoll=i(t.jQuery))}(this,function(t){"use strict";function i(){this._init.apply(this,arguments)}var s=!1,e=navigator.appVersion.match(/MSIE (\d+\.\d)/),n=e&&e[1]-0;"Microsoft Internet Explorer"===navigator.appName&&n<=8&&(s=!0);var h=t(window),r={prevBtn:"",nextBtn:"",isVer:!1,frameRate:40},o=i.prototype;return o._init=function(i,s){var e=t.extend({},r,s);this._$prevBtn=t(e.prevBtn),this._$nextBtn=t(e.nextBtn),this._hasPrevBtn=!!this._$prevBtn.length,this._hasNextBtn=!!this._$nextBtn.length,this._isVer=e.isVer,this._frameRate=e.frameRate,this._isRoll=!1,this._isSlide=!1,this._inited=!1,this._$container=t(i).css({overflow:"hidden","user-select":"none"}),this._$wrap=this._$container.children().first(),this._$content=this._$wrap.children(),t.cssHooks.x?(this._isVer?this.tabAttr="y":this.tabAttr="x",t.support.transform3d&&this._$wrap.css("z",0)):(this._$wrap.css("position","relative"),this._isVer?this.tabAttr="top":this.tabAttr="left"),this._sizeApi=this._isVer?"height":"width",this._prevTab=t.proxy(this,"prevTab"),this._nextTab=t.proxy(this,"nextTab"),this._resize=t.proxy(this,"_resize"),this._run=t.proxy(this,"_run"),this.update(),this._addEvent()},o._addEvent=function(){h.on("resize",this._resize),this._hasPrevBtn&&this._$prevBtn.on("click",this._prevTab),this._hasNextBtn&&this._$nextBtn.on("click",this._nextTab)},o._removeEvent=function(){h.off("resize",this._resize),this._hasPrevBtn&&this._$prevBtn.off("click",this._prevTab),this._hasNextBtn&&this._$nextBtn.off("click",this._nextTab)},o._resize=function(){t.contains(document,this._$wrap[0])&&(this._isRoll&&this._stop(),function(i,s,e){var n=t();t.each(i,function(i,s){for(var e,h=s instanceof jQuery?s:t(s),r=h.parents().addBack().filter(":hidden"),i=r.length;i--&&h.is(":hidden");)"none"===(e=r.eq(i)).css("display")&&(n=n.add(e.show()))}),"function"==typeof s&&s.call(e||this),n.hide()}(this._$wrap,function(){this.containerSize=this._$container[this._sizeApi]();var i=[0],s=0,e=0,n="outer"+this._sizeApi.substr(0,1).toUpperCase()+this._sizeApi.substr(1);this._$content.css(this._sizeApi,"").each(function(){e=t(this)[n](!0),s+=e,i.push(-s)}),this.itemPos=i,this.itemCount=i.length-1,this.contentSize=s},this),this.totalTime=this._frameRate*this.contentSize,this.maxPos=-this.contentSize,this.wrapSize=this.contentSize,this._clone(),this._inited=!0,this._isRoll?this._run():this._reset())},o._clone=function(){this.wrapSize<this.containerSize+this.contentSize&&(this.wrapSize+=this.contentSize,this._$wrap.append(this._$content.clone()),this._clone())},o._getIndex=function(){var i=this.curPos,s=-1;return t.each(this.itemPos,function(t,e){if(i>e)return!1;s=t}),s},o._gotoIndex=function(t){this._isSlide=!0,t<0&&(t=(t%this.itemCount+this.itemCount)%this.itemCount,this.curPos-=this.contentSize,this._$wrap.css(this.tabAttr,this.curPos));var i=this,s=this.itemPos[t],e={};e[this.tabAttr]=s,this._$wrap.animate(e,function(){i._isSlide=!1,i._run()})},o._reset=function(){this.curPos=parseFloat(this._$wrap.css(this.tabAttr)),this.curPos>0?this.curPos-=this.contentSize:this.curPos<=this.maxPos&&(this.curPos+=this.contentSize),this._$wrap.css(this.tabAttr,this.curPos)},o._getTime=function(){return(1-this.curPos/this.maxPos)*this.totalTime},o._run=function(){if(this._inited){this._reset();var t={};t[this.tabAttr]=this.maxPos,this._$wrap.animate(t,this._getTime(),"linear",this._run)}},o._stop=function(){this._$wrap.stop(),this._reset()},o.play=function(){this._isRoll||(this._isRoll=!0,this._run())},o.stop=function(){this._isRoll&&(this._isRoll=!1,this._stop())},o.prevTab=function(){if(!this._isSlide){this._stop();var t=this._getIndex();this._gotoIndex(--t)}},o.nextTab=function(){if(!this._isSlide){this._stop();var t=this._getIndex();this._gotoIndex(++t)}},o.update=function(){this._$wrap.empty(),this._$wrap.append(this._$content),s?window.setTimeout(this._resize,0):this._resize()},o.destroy=function(){this._removeEvent(),this._$container=null,this._$wrap=null,this.$item=null,this._$prevBtn=null,this._$nextBtn=null},i});