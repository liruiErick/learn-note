!function(t,i){"use strict";"object"==typeof module&&"object"==typeof exports?module.exports=i(require("jquery"),require("DragEvent")):"function"==typeof define&&define.amd?define(["jquery","DragEvent"],i):(t.bjj=t.bjj||{},t.bjj.Slider=i(t.jQuery,t.bjj.DragEvent))}(this,function(t,i){"use strict";function s(){this._init.apply(this,arguments)}function e(i,s,e){var h=t();t.each(i,function(i,s){for(var e,n=s instanceof jQuery?s:t(s),a=n.parents().addBack().filter(":hidden"),i=a.length;i--&&n.is(":hidden");)e=a.eq(i),"none"===e.css("display")&&(h=h.add(e.show()))}),"function"==typeof s&&s.call(e||this),h.hide()}var h=!!navigator.userAgent.match(/mobile/i),n=t(window),a={item:">",prevBtn:null,nextBtn:null,btnDisableClass:"disabled",align:"start",isVer:!1,offset:0,activeClass:"active",initIndex:0,duration:400,aequilate:!0,onClick:function(){},onSlide:function(){}},r=s.prototype;return r._init=function(i,s){var e=t.extend({},a,s);this.$container=t(i).css({overflow:"hidden","user-select":"none"}),this.$wrap=this.$container.children().first().css("cursor","-webkit-grab"),this.item=e.item,this.$prevBtn=t(e.prevBtn),this.$nextBtn=t(e.nextBtn),this.hasPrevBtn=!!this.$prevBtn.length,this.hasNextBtn=!!this.$nextBtn.length,this.btnDisableClass=e.btnDisableClass,this.isVer=e.isVer,this.offset=e.offset,this.activeClass=e.activeClass,this.duration=e.duration,this.aequilate=e.aequilate,this.onClick=e.onClick,this.onSlide=e.onSlide,this.hasPrevBtn&&this.$prevBtn.css("user-select","none"),this.hasNextBtn&&this.$nextBtn.css("user-select","none"),this.sizeRatio="end"===e.align?1:"center"===e.align?.5:0,t.cssHooks.x?(this.tabAttr=this.isVer?"y":"x",t.support.transform3d&&this.$wrap.css("z",0)):(this.tabAttr=this.isVer?"top":"left","static"===this.$wrap.css("position")&&this.$wrap.css("position","relative")),this.isVer?(this.beforeType="top",this.afterType="bottom",this.sizeApi="height"):(this.beforeType="left",this.afterType="right",this.sizeApi="width"),this.prevPage=t.proxy(this,"prevPage"),this.nextPage=t.proxy(this,"nextPage"),this._resize=t.proxy(this,"_resize"),this._onClick=t.proxy(this,"_onClick"),this.update(e.initIndex),this._addEvent()},r._addEvent=function(){n.on("resize",this._resize),h?(this.hasPrevBtn&&this.$prevBtn.on("touchend",this.prevPage),this.hasNextBtn&&this.$nextBtn.on("touchend",this.nextPage)):(this.hasPrevBtn&&this.$prevBtn.on("click",this.prevPage),this.hasNextBtn&&this.$nextBtn.on("click",this.nextPage)),this.startPos=0,this.curPos=0,this.horizontal=!1,this.vertical=!1,this.startX=0,this.startY=0,this.dx=0,this.dy=0,this.r=.5,this.dragEvent=new i({obj:this.$wrap,holder:this,start:this._touchstartHandler,move:this._touchmoveHandler,end:this._touchendHandler}),this.$wrap.on("click",this.item,this._onClick)},r._removeEvent=function(){h?(this.hasPrevBtn&&this.$prevBtn.off("touchend",this.prevPage),this.hasNextBtn&&this.$nextBtn.off("touchend",this.nextPage)):(this.hasPrevBtn&&this.$prevBtn.off("click",this.prevPage),this.hasNextBtn&&this.$nextBtn.off("click",this.nextPage)),this.dragEvent&&this.dragEvent.remove(),this.$wrap.off("click",this.item,this._onClick)},r._resize=function(){t.contains(document,this.$container[0])&&e(this.$wrap,function(){var i=this.$item.first(),s=parseInt(i.css("padding-"+this.beforeType))+parseInt(i.css("margin-"+this.beforeType))+parseInt(i.css("border-"+this.beforeType+"-width")),e=parseInt(i.css("padding-"+this.afterType))+parseInt(i.css("margin-"+this.afterType))+parseInt(i.css("border-"+this.afterType+"-width")),h=s-e,n=this.$item.last(),a=parseInt(n.css("padding-"+this.beforeType))+parseInt(n.css("margin-"+this.beforeType))+parseInt(n.css("border-"+this.beforeType+"-width")),r=parseInt(n.css("padding-"+this.afterType))+parseInt(n.css("margin-"+this.afterType))+parseInt(n.css("border-"+this.afterType+"-width")),o=r-a,c=0,l=h+o;0===l&&(c=h),this.parentSize=this.$container[this.sizeApi](),this.itemSize=[],this.itemPos=[];var p=this,u=0,d=e+a,f=parseInt(this.$wrap.css("padding-"+this.beforeType))+parseInt(this.$wrap.css("padding-"+this.afterType));if(this.aequilate){var m=this.$item[this.sizeApi]()+d;this.$item.each(function(t){p.itemPos.push(-m*t+p.offset),p.itemSize.push(m)}),u=m*this.itemCount+l,this.displayCount=this.parentSize/m|0}else this.$item.each(function(i,s){p.itemPos.push(-u+p.offset);var e=t(s),h=e.css(p.sizeApi,"")[p.sizeApi]();e[p.sizeApi](h),h+=d,p.itemSize.push(h),u+=h}),u+=l;this.minPos=this.offset,this.maxPos=this.parentSize-f-u-c-this.offset,this.maxPos=Math.min(this.maxPos,0),this.$wrap[this.sizeApi](u),this.ailgnOffset=(this.parentSize-(l+c+2*this.offset))*this.sizeRatio,this.minIndex=Math.max(0,Math.floor(this._calculateMultiple(this.minPos)-this.sizeRatio)),this.maxIndex=Math.min(this.itemCount-1,Math.ceil(this._calculateMultiple(this.maxPos)-this.sizeRatio)),this._slide(0)},this)},r._limitIndex=function(t){return Math.min(this.maxIndex,Math.max(this.minIndex,t))},r._fixedRange=function(t){return Math.min(this.minPos,Math.max(this.maxPos,t))},r._outOfRange=function(t){return t>this.minPos&&(t*=.3),t<this.maxPos&&(t=.3*(t-this.maxPos)+this.maxPos),t},r._gotoPos=function(t){var i={};i[this.tabAttr]=t,this.$wrap.css(i)},r._slide=function(t){"number"!=typeof t&&(t=this.duration);var i=this._limitIndex(this.curIndex),s=this.itemPos[i],e={};return e[this.tabAttr]=this._fixedRange(s+this.ailgnOffset-this.itemSize[i]*this.sizeRatio),this.curItemOffset=e[this.tabAttr]-this.itemPos[this.curIndex],this.onSlide.call(this.$item[this.curIndex],this.curIndex,this.curItemOffset),this.minPos>this.maxPos?(this.hasPrevBtn&&(this.curIndex<=this.minIndex?this.$prevBtn.addClass(this.btnDisableClass):this.$prevBtn.removeClass(this.btnDisableClass)),this.hasNextBtn&&(this.curIndex>=this.maxIndex?this.$nextBtn.addClass(this.btnDisableClass):this.$nextBtn.removeClass(this.btnDisableClass))):(this.hasPrevBtn&&this.$prevBtn.addClass(this.btnDisableClass),this.hasNextBtn&&this.$nextBtn.addClass(this.btnDisableClass)),this.$wrap.stop().animate(e,t),this.curItemOffset},r._onClick=function(t){if(this.isClick){var i=this.$item.index(t.currentTarget);this.setItem(i),this.onClick.call(t.currentTarget,i)}},r._touchstartHandler=function(t,i){this.isClick=!0,this.startX=i.x,this.startY=i.y,this.$wrap.css("cursor","-webkit-grabbing")},r._touchmoveHandler=function(t,i){if(this.dx=i.x-this.startX,this.dy=i.y-this.startY,!this.horizontal&&!this.vertical){var s=Math.abs(this.dx),e=Math.abs(this.dy);this.isVer?e>=s?(this.vertical=!0,this.$wrap.stop(),this.startPos=parseInt(this.$wrap.css(this.tabAttr))):(this.horizontal=!0,this.startX=i.x,this.startY=i.y):s>=e?(this.horizontal=!0,this.$wrap.stop(),this.startPos=parseInt(this.$wrap.css(this.tabAttr))):(this.vertical=!0,this.startX=i.x,this.startY=i.y)}!this.isVer&&!this.horizontal||this.isVer&&!this.vertical||(t.preventDefault(),this.isClick=!1,this.curPos=this._outOfRange(this.isVer?this.startPos+this.dy:this.startPos+this.dx),this._gotoPos(this.curPos))},r._touchendHandler=function(t,i){if(this.$wrap.css("cursor","-webkit-grab"),this.isVer){if(this.horizontal=!1,!this.vertical)return;this.vertical=!1}else{if(this.vertical=!1,!this.horizontal)return;this.horizontal=!1}if(this.isVer&&(i.swipeTop||i.swipeBottom))i.swipeTop?this.nextPage():i.swipeBottom&&this.prevPage();else if(this.isVer||!i.swipeLeft&&!i.swipeRight){var s=this._calculateMultiple(this.curPos)-this.sizeRatio;this.curIndex=this.isVer?this.dy<0?Math.ceil(s-this.r):Math.floor(s+this.r):this.dx<0?Math.ceil(s-this.r):Math.floor(s+this.r),this._slide()}else i.swipeLeft?this.nextPage():i.swipeRight&&this.prevPage();return!1},r._calculateMultiple=function(t){var i=0,s=t-this.ailgnOffset-this.offset;if(this.aequilate)0>s&&(i=Math.max(0,-s)/this.itemSize[0]);else for(var e,h,n=0,a=this.itemCount;a>n;n++)if(e=this.itemPos[n],h=this.itemSize[n],s>e-h){i=Math.max(0,e-s)/h+n;break}return i},r.prevPage=function(){var t=this.curIndex;if(this.aequilate)t-=this.displayCount;else for(var i,s=this.itemPos[t],e=t;e>=0&&(i=this.itemPos[e],!(i-s>=this.parentSize));e--)t=e;t=Math.max(this.minIndex,t),this.curIndex=t,this._slide()},r.nextPage=function(){var t=this.curIndex;if(this.aequilate)t+=this.displayCount;else for(var i,s=this.itemPos[t],e=t,h=this.itemCount;h>e&&(i=this.itemPos[e],!(s-i>=this.parentSize));e++)t=e;t=Math.min(this.maxIndex,t),this.curIndex=t,this._slide()},r.update=function(t){this.$item=this.$wrap.find(this.item),this.itemCount=this.$item.length,this.curIndex="number"==typeof t&&t>=0&&t<this.itemCount?t:1===this.sizeRatio?itemCount-1:0,this.setItem(t),window.setTimeout(this._resize)},r.setItem=function(t){this.curActiveIndex=t,this.$item.removeClass(this.activeClass),0>t||t>=this.itemCount||this.$item.eq(t).addClass(this.activeClass)},r.gotoItem=function(t){return this.curIndex=t,this._slide()},r.destroy=function(){this._removeEvent(),this.$container=null,this.$wrap=null,this.$item=null,this.$prevBtn=null,this.$nextBtn=null},s});