!function(t,a){"use strict";"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a(require("jquery")):(t.bjj=t.bjj||{},t.bjj.DragEvent=a(t.jQuery))}(this,function(t){"use strict";function a(){this._init.apply(this,arguments)}var e,s,i,n,h=!!navigator.userAgent.match(/mobile/i),d="ontouchend"in document,o=!!window.navigator.pointerEnabled,c=!!window.navigator.msPointerEnabled;h?d?(e="touchstart",s="touchmove",i="touchend",n="touchcancel"):o?(e="pointerdown",s="pointermove",i="pointerup"):c?(e="MSPointerDown",s="MSPointerMove",i="MSPointerUp"):(e="mousedown",s="mousemove",i="mouseup"):(e="mousedown",s="mousemove",i="mouseup"),a.startEvent=e,a.moveEvent=s,a.endEvent=i,a.cancelEvent=n,a.nameSpace=1;var r=a.prototype;return r.constructor=a,r._init=function(e){this.eventObj=e.obj||document.documentElement,this.callbackHolder=e.holder,this.startCallback=e.start,this.moveCallback=e.move,this.endCallback=e.end,this.startEvent=a.startEvent+"."+a.nameSpace,this.moveEvent=a.moveEvent+"."+a.nameSpace,this.endEvent=a.endEvent+"."+a.nameSpace,this.cancelEvent=a.cancelEvent+"."+a.nameSpace,a.nameSpace++,this.touchID=-1,this.swipeDis=5,this.swipeTime=200,this.swipeH=!1,this.swipeV=!1,this.prevTime=0,this.data={},this.data.startX=0,this.data.startY=0,this.data.startLocalX=0,this.data.startLocalY=0,this.data.x=0,this.data.y=0,this.data.localX=0,this.data.localY=0,this.data.dx=0,this.data.dy=0,this.data.absDx=0,this.data.absDy=0,this.data.stepDx=0,this.data.stepDy=0,this.data.absStepDx=0,this.data.absStepDy=0,this.data.swipeLeft=!1,this.data.swipeRight=!1,this.data.swipeTop=!1,this.data.swipeBottom=!1,this.data.swipe=!1,this.data.startTime=0,this.data.stepTime=0,this._startDragHandler=t.proxy(this,"_startDragHandler"),this._moveDragHandler=t.proxy(this,"_moveDragHandler"),this._endDragHandler=t.proxy(this,"_endDragHandler"),this.$doc=t(document),this.$eventObj=t(this.eventObj),this.eventObj=this.$eventObj[0],this.$eventObj.on(this.startEvent,this._startDragHandler),this.eventTarget=null},r._startDragHandler=function(a){var e;switch(a.type){case"mousedown":case"pointerdown":case"MSPointerDown":e=a;break;case"touchstart":if(this.touchID>=0)return;e=a.originalEvent.changedTouches[0],this.touchID=e.identifier}this.data.dx=0,this.data.dy=0,this.data.absDx=0,this.data.absDy=0,this.data.stepDx=0,this.data.stepDy=0,this.data.absStepDx=0,this.data.absStepDy=0,this.data.swipeLeft=!1,this.data.swipeRight=!1,this.data.swipeTop=!1,this.data.swipeBottom=!1,this.data.swipe=!1,this.data.startX=this.data.x=e.clientX,this.data.startY=this.data.y=e.clientY,this.data.stepTime=0,this.data.startTime=this.prevTime=a.timeStamp;var s=this.eventObj.getBoundingClientRect?this.eventObj.getBoundingClientRect():{left:document.documentElement.scrollLeft||document.body.scrollLeft,top:document.documentElement.scrollTop||document.body.scrollTop};return this.data.startLocalX=this.data.localX=this.data.x-s.left,this.data.startLocalY=this.data.localY=this.data.y-s.top,this.eventTarget=a.currentTarget,this.startCallback&&this.startCallback.call(this.callbackHolder||this.eventTarget,a,t.extend({},this.data))===!1?void(this.touchID=-1):(this.$doc.on(this.moveEvent,this._moveDragHandler).on(this.endEvent,this._endDragHandler),void(n&&this.$doc.on(this.cancelEvent,this._endDragHandler)))},r._moveDragHandler=function(a){var e;switch(a.type){case"mousemove":case"pointermove":case"MSPointerMove":e=a;break;case"touchmove":if(e=a.originalEvent.changedTouches[0],e.identifier!=this.touchID)return}this.data.dx=e.clientX-this.data.startX,this.data.dy=e.clientY-this.data.startY,this.data.absDx=Math.abs(this.data.dx),this.data.absDy=Math.abs(this.data.dy),this.data.stepDx=e.clientX-this.data.x,this.data.stepDy=e.clientY-this.data.y,this.data.absStepDx=Math.abs(this.data.stepDx),this.data.absStepDy=Math.abs(this.data.stepDy),this.data.x=e.clientX,this.data.y=e.clientY;var s=this.eventObj.getBoundingClientRect?this.eventObj.getBoundingClientRect():{left:document.documentElement.scrollLeft||document.body.scrollLeft,top:document.documentElement.scrollTop||document.body.scrollTop};this.data.localX=this.data.x-s.left,this.data.localY=this.data.y-s.top;var i=a.timeStamp;this.data.stepTime=i-this.prevTime,this.prevTime=i,this.swipeH=this.data.absStepDx>this.swipeDis?!0:!1,this.swipeV=this.data.absStepDy>this.swipeDis?!0:!1,this.moveCallback&&this.moveCallback.call(this.callbackHolder||this.eventTarget,a,t.extend({},this.data))},r._endDragHandler=function(a){var e;switch(a.type){case"mouseup":case"pointerup":case"MSPointerUp":e=a;break;case"touchend":case"touchcancel":if(e=a.originalEvent.changedTouches[0],e.identifier!=this.touchID)return;this.touchID=-1}this.$doc.off(this.moveEvent,this._moveDragHandler).off(this.endEvent,this._endDragHandler),n&&this.$doc.on(this.cancelEvent,this._endDragHandler),this.data.x=e.clientX,this.data.y=e.clientY;var s=this.eventObj.getBoundingClientRect?this.eventObj.getBoundingClientRect():{left:document.documentElement.scrollLeft||document.body.scrollLeft,top:document.documentElement.scrollTop||document.body.scrollTop};this.data.localX=this.data.x-s.left,this.data.localY=this.data.y-s.top,this.data.dx=this.data.x-this.data.startX,this.data.dy=this.data.y-this.data.startY,this.data.absDx=Math.abs(this.data.dx),this.data.absDy=Math.abs(this.data.dy),this.data.stepTime<this.swipeTime&&(this.swipeH&&(this.swipeH=!1,this.data.swipe=!0,this.data.stepDx<0?this.data.swipeLeft=!0:this.data.stepDx>0&&(this.data.swipeRight=!0)),this.swipeV&&(this.swipeV=!1,this.data.swipe=!0,this.data.stepDy<0?this.data.swipeTop=!0:this.data.stepDy>0&&(this.data.swipeBottom=!0))),(this.data.absDx>15||this.data.absDy>15)&&a.preventDefault(),this.endCallback&&this.endCallback.call(this.callbackHolder||this.eventTarget,a,t.extend({},this.data)),this.eventTarget=null},r.open=function(){this.$eventObj.on(this.startEvent,this._startDragHandler)},r.close=function(){this.$eventObj.off(this.startEvent,this._startDragHandler)},r.stop=function(){this.touchID=-1,this.$doc.off(this.moveEvent,this._moveDragHandler).off(this.endEvent,this._endDragHandler)},r.remove=function(){this.close(),this.stop()},a});