# 文件权限设置

在发布站点的时候，有时候目录是可以有写入权限的，但是目录下的文件是不允许修改的。这对于防范黑客很有益。


## 查看文件权限

查看某个文件权限的命令

```
$ ls -l <文件名>
```

查看某个目录里所有文件/子目录的权限

```
$ ls -l <目录名>
```

由于无法单独查看某个目录的权限，因此只能通过在该目录的上级目录下执行以下命令，来查看所有文件/子目录权限

```
$ ls -l
```

以下为打印出的某一个文件的权限信息

```
-rw-r--r--@ 1 baijunie  staff  105  4 13 17:45 <文件名>
drwxr-xr-x  2 baijunie  staff  68  4 13 17:57 <子目录名>
```

**权限信息格式如下**

```
-rwxrw-r--　number　user　group　filesize　updatetime　filename
```

- `-rwxrw-r--` - 表示文件权限，总共 10 个字符

  第一个字符是 `-`，表示类型，通常文件都是 `-`。当然还有其他类型，比如 `d` 表示目录等。

  接下来3个字符是 `rwx`，表示该文件对于当前用户的权限是 `r/w/x`，即当前用户拥读取、写入、执行权限。

  再接下来3个字符是 `rw-`，表示该文件对于当前用户所在的组的成员来说，只拥有读取权限和写入权限，但是不能执行，所以执行权限块是 `-`，表示没有执行权限。

  最后3个字符是 `r--`，表示该文件对于其他用户来说，只有读取权限，没有写入和执行的权限。

  另外，有的文件后面还有个 `@`，这个其实是 Mac 系统的文件自带的一个表示文件有扩展属性的标示，与权限无关。 

- `number` - 即文件inode数量，inode表示储存文件元信息的区域

- `user` - 即当前用户名

- `group` - 即当前用户所在的组的名字

- `filesize` - 即该文件大小，单位是byte

- `updatetime` - 即文件的最后修改时间

- `filename` - 即文件名


## 修改文件权限

在 Linux 中，一般使用 `chmod` 命令来修改文件的属性。命令格式如下

```
$ chmod [参数] [<权限范围><权限操作><具体权限>] [文件或目录…]
```

#### 参数

`-c` / `--changes` - 若该文件权限确实已经更改，才显示其更改动作

`-f` / `--quiet` / `--silent` - 若该文件权限无法被更改也不要显示错误讯息

`-v` / `--verbose` - 显示权限变更的详细资料

`-R` / `--recursive` - 对当前目录下的所有文件与子目录内文件进行相同的权限变更(即以递归的方式逐个变更)

`--reference=<参考文件或目录>` - 把指定文件或目录的权限全部设成和参考文件或目录的权限相同

`--help` - 显示辅助说明

`--version` - 显示版本

#### 权限范围

Linux 用户分为： 拥有者(User)、组群(Group)、其他（other）

`u` - User，即文件或目录的拥有者。

`g` - Group，即文件或目录的所属群组。

`o` - Other，除了文件或目录拥有者或所属群组之外，其他用户皆属于这个范围。

`a` - All，即全部的用户，包含拥有者，所属群组以及其他用户。

#### 权限操作

`+` - 表示增加权限

`-` - 表示取消权限

`=` - 表示设定权限

#### 具体权限

`r` - 表示可读取，数字表示为 4

`w` - 表示可写入，数字表示为 2

`x` - 表示可执行，数字表示为 1

`X` - 用于设置目录下子文件权限时，表示仅将子目录设置成可执行

同时，设置具体权限时还可以使用数字表示

```
$ chmod <ugo> <file_name>
```

其中，`ugo` 分别表示User、Group、及Other的权限。

`u`, `g` , `o` 各为一个数字。

`rwx` 相当于 `4+2+1=7`

`rw-` 相当于 `4+2=6`

`r-x` 相当于 `4+1=5`

例如，赋予所有用户读取、写入、执行权限

```
$ chmod a=rwx <file_name>
```

等同于

```
$ chmod 777 <file_name>
```


#### 操作实例

为所有用户增加执行权限，不加权限范围，则默认表示所有用户

```
$ chmod +x <file_name>
```

为其他用户增加写入权限

```
$ chmod o+w <file_name>
```

为所属群组以及其他用户增加写入权限与执行权限

```
$ chmod go+w+x <file_name>
```

关闭所属群组以及其他用户对当前目录的执行权限，目录将无法被他们打开

```
$ chmod go-x ./
```

增加所属群组以及其他用户对当前目录下所有文件、子目录（不包含子目录内文件）的写入权限

```
$ chmod go+w ./*
```

增加所属群组以及其他用户对当前目录以及当前目录下所有文件、子目录及子目录内文件的写入权限

```
$ chmod -R go+w ./
```

有时，并不想笼统的将文件与子目录的权限设置成一样，因为一般文件不需要执行权限，而子目录又需要执行权限，因此需要分开设置

设置指定目录下文件权限为 644

```
$ find <目录路径> -type f -exec chmod 644 {} \;
```

设置指定目录下子目录权限为 755

```
$ find <目录路径> -type d -exec chmod 755 {} \;
```